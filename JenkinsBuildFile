pipeline{

   agent { label "QA-Slave" }
    
    
    environment{
    NAME="Ngwesse Elvis"
    BuildOutput="./BuildOutput"  
    }
    
     stage('Cleaning Workspace'){
            steps{
                echo 'Cleaning Workspace'
                cleanWs()
            }
        }
        

    stages{
        stage('Checkout from SCM'){
            steps{
                echo 'Checking Out from GitHub'
                echo "NAME = ${env.NAME}"
            }
        }
        
          

        stage('Restore Solution'){
            steps{
                echo 'Restoring Solution'
                sh "dotnet restore LoginApp.sln"
            }
        }

        stage('Build Solution'){
            steps{
                echo 'Building Solution'
                 sh 'dotnet build LoginApp.sln'
            }
        }

        stage('Testing Project'){
            steps{
                echo 'Running unit tests'
                 sh 'dotnet test'
            }

        }

        stage('Publish build'){
            steps{
                 echo 'Publishing Solution'
                sh 'dotnet publish -c Release -r win-x64 --output ${BuildOutput} LoginApp.sln'
            }

        }
        
        
         
     

    }
}
